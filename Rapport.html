<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Welcome file</title>
  <link rel="stylesheet" href="https://stackedit.io/style.css" />
</head>

<body class="stackedit">
  <div class="stackedit__html"><h1 id="üìä-rapport-du-projet-administration-syst√®me-linux">üìä Rapport du Projet Administration Syst√®me Linux</h1>

<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Auteur</strong></td>
<td>Hamady GACKOU</td>
</tr>
<tr>
<td><strong>Encadrant</strong></td>
<td>Fran√ßois-Xavier JOLLOIS, PhD</td>
</tr>
<tr>
<td><strong>√âtablissement</strong></td>
<td>Universit√© Paris Cit√©, UFR : Sciences fondamentales et biom√©dicales</td>
</tr>
<tr>
<td><strong>Programme</strong></td>
<td>M1 : AMSD</td>
</tr>
<tr>
<td><strong>Sujet</strong></td>
<td>Analyse et Visualisation des Donn√©es Multi-Sectorielles :    √âv√©nements, Sports et √âconomie</td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
</tbody>
</table><h1 id="table-de-mati√®re">Table de mati√®re</h1>
<ul>
<li><a href="#table-de-mati%C3%A8re">Table de mati√®re</a>
<ul>
<li><a href="#probl%C3%A9matique">Probl√©matique</a></li>
<li><a href="#importance-du-sujet">Importance du sujet</a></li>
<li><a href="#objectifs-concrets">Objectifs concrets</a></li>
<li><a href="#api-utilis%C3%A9es">API utilis√©es</a>
<ul>
<li><a href="#1-ticketmaster-api">1. <strong>Ticketmaster API</strong></a></li>
<li><a href="#2-football-data-api">2. <strong>Football Data API</strong></a></li>
<li><a href="#3-world-bank-api">3. <strong>World Bank API</strong></a></li>
<li><a href="#4-points-communs-entre-les-sources-de-donn%C3%A9es">4. <strong>Points communs entre les sources de donn√©es</strong></a></li>
<li><a href="#5-volum%C3%A9trie-%C3%A0-pr%C3%A9voir-">5. <strong>Volum√©trie √† pr√©voir</strong> :</a></li>
<li><a href="#6-limite-des-api">6. Limite des API</a>
<ul>
<li><a href="#ticketmaster-api-"><strong>TicketMaster API :</strong></a></li>
<li><a href="#football-api-api-football-"><strong>Football API (API-FOOTBALL) :</strong></a></li>
<li><a href="#world-bank-api-"><strong>World Bank API :</strong></a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#importation-et-transformation-des-donn%C3%A9es">Importation et Transformation des Donn√©es</a>
<ul>
<li><a href="#1-api-ticketmaster-%C3%A9v%C3%A9nements">1. API Ticketmaster (√âv√©nements)</a></li>
<li><a href="#code-dimportation">Code d‚ÄôImportation</a></li>
<li><a href="#code-de-transformation">Code de Transformation</a></li>
<li><a href="#2-api-football">2. API Football</a></li>
<li><a href="#code-dimportation-1">Code d‚Äôimportation</a></li>
<li><a href="#code-de-transformation-1">Code de Transformation</a></li>
<li><a href="#3-api-world-bank">3. API World Bank</a></li>
<li><a href="#code-dimportation-2">Code d‚Äôimportation</a></li>
<li><a href="#code-de-transformation-2">Code de Transformation</a></li>
</ul>
</li>
<li><a href="#fichier-chron-">Fichier Chron :</a></li>
<li><a href="#cron-job---automatisation-du--fichier-chron-ci-dessus">Cron Job :  Automatisation du  fichier chron ci dessus</a></li>
<li><a href="#exploration-de-la-base-de-donn%C3%A9es-mongodb">Exploration de la base de donn√©es MongoDB</a></li>
<li><a href="#cron-job">Cron Job</a></li>
<li><a href="#conception-du-tableau--de-bord-">Conception du tableau  de bord :</a>
<ul>
<li><a href="#outils-utilis%C3%A9s">Outils utilis√©s</a></li>
</ul>
</li>
<li><a href="#difficult%C3%A9s-de-d%C3%A9ploiement-des-t%C3%A2ches-planifi%C3%A9es-sur-les-plateformes-de-d%C3%A9ploiement-">Difficult√©s de D√©ploiement des T√¢ches Planifi√©es sur les Plateformes de D√©ploiement :</a></li>
<li><a href="#lien-du--repo-github--">Lien du  repo Github  :</a></li>
<li><a href="#conclusion-">Conclusion :</a></li>
<li><a href="#perspectives-">Perspectives :</a></li>
</ul>
</li>
</ul>
<h2 id="probl√©matique">Probl√©matique</h2>
<p>Comment pouvons-nous concevoir un tableau de bord temps r√©el int√©grant des donn√©es sur les √©v√©nements culturels, les performances sportives (football) et les indicateurs √©conomiques, afin d‚Äôanalyser l‚Äôinteraction entre l‚Äôactivit√© humaine, l‚Äô√©conomie et le sport dans une zone g√©ographique donn√©e ?</p>
<h2 id="importance-du-sujet">Importance du sujet</h2>
<p>Ce projet vise √† d√©montrer comment des donn√©es disparates, mais interd√©pendantes, peuvent √™tre collect√©es, analys√©es et visualis√©es en temps r√©el pour r√©v√©ler des insights significatifs. Dans un monde o√π les d√©cisions √©conomiques, sociales et organisationnelles s‚Äôappuient de plus en plus sur des donn√©es actualis√©es, ce tableau de bord fournit un outil unique pour comprendre l‚Äôimpact √©conomique et social des √©v√©nements culturels et sportifs.</p>
<h2 id="objectifs-concrets">Objectifs concrets</h2>
<ol>
<li><strong>Centraliser et analyser des donn√©es multi-sources</strong> : √âv√©nements, performances sportives, et indicateurs √©conomiques √† partir de diff√©rentes API en temps r√©el.</li>
<li><strong>Mettre en √©vidence les interactions potentielles</strong> : Par exemple, l‚Äôimpact des √©v√©nements culturels et sportifs sur les indicateurs √©conomiques locaux, ou l‚Äôinfluence des performances sportives sur la popularit√© des √©quipes et leurs r√©gions.</li>
<li><strong>D√©velopper un outil d‚Äôaide √† la d√©cision</strong> : Un tableau de bord visuel et interactif permettant de suivre et de pr√©voir les tendances, utile pour les gestionnaires d‚Äô√©v√©nements, les √©conomistes ou les autorit√©s locales.</li>
<li><strong>D√©montrer la faisabilit√© technique</strong> : Validation du concept avec des scripts d‚Äôautomatisation et une analyse p√©riodique r√©sum√©e dans MongoDB, tout en garantissant la pertinence et l‚Äôactualit√© des donn√©es affich√©es.</li>
</ol>
<h2 id="api-utilis√©es">API utilis√©es</h2>
<h3 id="ticketmaster-api">1. <strong>Ticketmaster API</strong></h3>
<ul>
<li><strong>Nature</strong> : Temps r√©el</li>
<li><strong>Contenu des donn√©es</strong> : Cette API fournit des informations sur les √©v√©nements (concerts, festivals, √©v√©nements sportifs, etc.), telles que :
<ul>
<li>Nom de l‚Äô√©v√©nement</li>
<li>Date et heure de l‚Äô√©v√©nement</li>
<li>Lieu (salle, stade, etc.)</li>
<li>Ville et pays</li>
<li>Cat√©gorie d‚Äô√©v√©nement (musique, sport, th√©√¢tre, etc.)</li>
<li>Informations sur les billets , prix</li>
</ul>
</li>
<li><strong>P√©riodicit√©</strong> : Les donn√©es sont mises √† jour en temps r√©el, selon la disponibilit√© des √©v√©nements et des informations mises √† jour par Ticketmaster.</li>
<li><strong>Moyen d‚Äôacc√®s aux donn√©es</strong> :
<ul>
<li><strong>API</strong> : Les donn√©es sont accessibles via une API RESTful.</li>
<li><strong>Cl√© API</strong> : Une cl√© d‚ÄôAPI est n√©cessaire pour l‚Äôacc√®s aux donn√©es. Cette cl√© peut √™tre obtenue en s‚Äôinscrivant sur le site de Ticketmaster.</li>
</ul>
</li>
<li><strong>Droit de r√©utilisation des donn√©es</strong> :
<ul>
<li><strong>Conditions d‚Äôutilisation</strong> : Les donn√©es sont prot√©g√©es par des droits d‚Äôauteur et soumises aux conditions d‚Äôutilisation de Ticketmaster. L‚Äôutilisation des donn√©es est g√©n√©ralement limit√©e aux applications non commerciales. Pour toute utilisation commerciale (comme la revente ou la diffusion de donn√©es √† des fins commerciales), une autorisation pr√©alable de Ticketmaster est requise.</li>
<li><strong>Restrictions</strong> : La r√©utilisation des donn√©es pour des projets commerciaux n√©cessite un accord sp√©cifique avec Ticketmaster.</li>
<li><strong>Volum√©trie √† pr√©voir sur une ann√©e d‚Äôutilisation</strong>:<br>
La volum√©trie d√©pendra du nombre d‚Äô√©v√©nements suivis, mais en moyenne, cela pourrait repr√©senter des centaines de milliers de requ√™tes sur une ann√©e, avec des pics lors de festivals ou √©v√©nements majeurs.</li>
</ul>
</li>
</ul>
<h3 id="football-data-api">2. <strong>Football Data API</strong></h3>
<ul>
<li><strong>Nature</strong> : Temps r√©el</li>
<li><strong>Contenu des donn√©es</strong> : Cette API fournit des donn√©es sur les comp√©titions de football √† travers le monde. Les informations incluent :
<ul>
<li>D√©tails sur les comp√©titions (nom de la comp√©tition, pays, saison)</li>
<li>R√©sultats des matchs</li>
<li>Classements des √©quipes</li>
<li>Statistiques de match (score, possession, tirs, etc.)</li>
</ul>
</li>
<li><strong>P√©riodicit√©</strong> : Les donn√©es sont mises √† jour en temps r√©el ou tr√®s proche du temps r√©el pendant les matchs. Les r√©sultats des matchs sont ajout√©s d√®s qu‚Äôils sont disponibles.</li>
<li><strong>Moyen d‚Äôacc√®s aux donn√©es</strong> :
<ul>
<li><strong>API</strong> : L‚Äôacc√®s aux donn√©es se fait via une API RESTful.</li>
<li><strong>Cl√© API</strong> : Une cl√© API est n√©cessaire pour authentifier les requ√™tes. Elle peut √™tre obtenue apr√®s inscription sur le site officiel de Football Data.</li>
</ul>
</li>
<li><strong>Droit de r√©utilisation des donn√©es</strong> :
<ul>
<li><strong>Conditions d‚Äôutilisation</strong> : Les donn√©es sont fournies sous des conditions d‚Äôutilisation sp√©cifiques. En g√©n√©ral, les donn√©es peuvent √™tre utilis√©es √† des fins personnelles ou acad√©miques. Pour un usage commercial (par exemple, pour une application de paris ou une plateforme commerciale), une licence sp√©cifique est requise.</li>
<li><strong>Restrictions</strong> : L‚Äôutilisation des donn√©es est limit√©e dans un cadre non commercial, sauf si un accord commercial est obtenu avec les propri√©taires des donn√©es.</li>
</ul>
</li>
<li><strong>Volum√©trie √† pr√©voir sur une ann√©e d‚Äôutilisation</strong>:<br>
Selon le nombre de comp√©titions suivies et la fr√©quence des matchs, la volum√©trie pourrait √™tre de plusieurs millions de requ√™tes sur l‚Äôann√©e, surtout en p√©riode de comp√©titions majeures (Coupes du Monde, Ligues, etc.).</li>
</ul>
<h3 id="world-bank-api">3. <strong>World Bank API</strong></h3>
<ul>
<li><strong>Nature</strong> : Pas en temps r√©el (donn√©es √©conomiques historiques)</li>
<li><strong>Contenu des donn√©es</strong> : Cette API fournit des donn√©es √©conomiques d√©taill√©es pour diff√©rents pays, notamment :
<ul>
<li>PIB par pays (en dollars constants ou courants)</li>
<li>Indicateurs √©conomiques comme la population, la croissance √©conomique, les investissements, etc.</li>
<li>Donn√©es sur la pauvret√©, l‚Äôacc√®s √† l‚Äô√©ducation, la sant√©, les infrastructures, etc.</li>
<li>Ces donn√©es couvrent plusieurs d√©cennies, avec des mises √† jour p√©riodiques.</li>
</ul>
</li>
<li><strong>P√©riodicit√©</strong> : Les donn√©es √©conomiques sont mises √† jour annuellement ou selon la publication de nouveaux rapports √©conomiques par la Banque Mondiale.
<ul>
<li>Les ensembles de donn√©es peuvent couvrir des p√©riodes comme 2013-2022, selon l‚Äôindicateur sp√©cifique.</li>
</ul>
</li>
<li><strong>Moyen d‚Äôacc√®s aux donn√©es</strong> :
<ul>
<li><strong>API</strong> : L‚Äôacc√®s aux donn√©es se fait via une API RESTful, sans n√©cessiter d‚Äôauthentification.</li>
<li><strong>T√©l√©chargement</strong> : Les donn√©es peuvent √©galement √™tre t√©l√©charg√©es en format JSON ou XML pour une utilisation hors ligne.</li>
<li><strong>Token n√©cessaire</strong> : Aucun token n‚Äôest n√©cessaire pour acc√©der aux donn√©es de l‚ÄôAPI.</li>
</ul>
</li>
<li><strong>Droit de r√©utilisation des donn√©es</strong> :
<ul>
<li><strong>Conditions d‚Äôutilisation</strong> : Les donn√©es sont ouvertes au public et peuvent √™tre utilis√©es gratuitement, sous r√©serve de respect des conditions d‚Äôutilisation de la Banque Mondiale. L‚Äôattribution est obligatoire si les donn√©es sont utilis√©es dans des publications ou des projets.</li>
<li><strong>Restrictions</strong> : Les donn√©es peuvent √™tre utilis√©es librement dans des projets acad√©miques, de recherche ou d‚Äôanalyse. Pour un usage commercial, il est recommand√© de v√©rifier les conditions sp√©cifiques sur le site de la Banque Mondiale.</li>
<li><strong>Volum√©trie √† pr√©voir sur une ann√©e d‚Äôutilisation</strong>:<br>
La volum√©trie peut √™tre modeste, en fonction du nombre d‚Äôindicateurs suivis, avec des centaines de milliers de points de donn√©es √† traiter sur l‚Äôann√©e.</li>
</ul>
</li>
</ul>
<h3 id="points-communs-entre-les-sources-de-donn√©es">4. <strong>Points communs entre les sources de donn√©es</strong></h3>
<ul>
<li><strong>Acc√®s via API</strong>: Toutes les trois API offrent un acc√®s via des appels RESTful.</li>
<li><strong>Donn√©es structur√©es en JSON</strong> : Les donn√©es sont principalement disponibles en format JSON, ce qui facilite leur traitement et leur int√©gration dans des applications.</li>
<li><strong>Utilisation en temps r√©el ou p√©riodique</strong> : Les deux premi√®res API (Ticketmaster et Football Data) offrent des donn√©es mises √† jour en temps r√©el, tandis que la troisi√®me (World Bank) propose des donn√©es historiques mises √† jour annuellement.</li>
<li><strong>N√©cessit√© d‚Äôune cl√© API pour deux</strong>: Ticketmaster et Football Data n√©cessitent une cl√© API pour acc√©der aux donn√©es, tandis que la Banque Mondiale permet un acc√®s libre sans cl√© API.</li>
</ul>
<h3 id="volum√©trie-√†-pr√©voir-">5. <strong>Volum√©trie √† pr√©voir</strong> :</h3>
<ul>
<li><strong>Ticketmaster API</strong> : La volum√©trie d√©pend des √©v√©nements suivis, mais elle peut atteindre des centaines de milliers de requ√™tes par an.</li>
<li><strong>Football Data API :</strong> En raison de la mise √† jour en temps r√©el, cette API peut g√©n√©rer plusieurs millions de requ√™tes annuellement, selon la fr√©quence des matchs.</li>
<li><strong>World Bank API</strong>: Cette API g√©n√®re moins de volum√©trie, mais peut contenir des centaines de milliers de points de donn√©es par an, selon les indicateurs suivis.</li>
</ul>
<h3 id="limite-des-api">6. Limite des API</h3>
<h4 id="ticketmaster-api-"><strong>TicketMaster API :</strong></h4>
<ul>
<li>Par seconde : 5 requ√™tes par seconde.</li>
<li>Par jour : 5000 requ√™tes par jour.</li>
</ul>
<h4 id="football-api-api-football-"><strong>Football API (API-FOOTBALL) :</strong></h4>
<p>Les limites d√©pendent du plan d‚Äôabonnement :</p>
<ul>
<li>Plan Gratuit : 10 requ√™tes par minute.</li>
<li>Plan Pro : 300 requ√™tes par minute.</li>
<li>Plan Ultra : 450 requ√™tes par minute.</li>
<li>Plan Mega : 900 requ√™tes par minute.</li>
<li>Plan Personnalis√© : Jusqu‚Äô√† 1200 requ√™tes par minute3.</li>
</ul>
<h4 id="world-bank-api-"><strong>World Bank API :</strong></h4>
<p>Les informations sp√©cifiques sur les limites de l‚ÄôAPI de la Banque Mondiale ne sont pas clairement d√©finies, mais l‚Äô API est con√ßue pour supporter un grand nombre de requ√™tes.</p>
<h2 id="importation-et-transformation-des-donn√©es">Importation et Transformation des Donn√©es</h2>
<h3 id="api-ticketmaster-√©v√©nements">1. API Ticketmaster (√âv√©nements)</h3>
<h3 id="code-dimportation">Code d‚ÄôImportation</h3>
<pre class=" language-bash"><code class="prism  language-bash"><span class="token shebang important">#!/bin/bash</span>

<span class="token comment"># Cl√© API Ticketmaster</span>
<span class="token function">export</span> <span class="token punctuation">$(</span>grep -v <span class="token string">'^#'</span> <span class="token punctuation">..</span>/.env <span class="token operator">|</span> xargs<span class="token punctuation">)</span>

API_KEY<span class="token operator">=</span><span class="token string">"<span class="token variable">$API_KEY_festival</span>"</span>

<span class="token comment"># URL de base de l'API Ticketmaster</span>
BASE_URL<span class="token operator">=</span><span class="token string">"https://app.ticketmaster.com/discovery/v2/events.json"</span>

<span class="token comment"># Param√®tres de la requ√™te</span>
START_DATE<span class="token operator">=</span><span class="token punctuation">$(</span>date -u -d <span class="token string">'8 hours ago'</span> +%Y-%m-%dT%H:%M:%SZ<span class="token punctuation">)</span>
PARAMS<span class="token operator">=</span><span class="token string">"apikey=<span class="token variable">$API_KEY</span>&amp;sort=date,desc&amp;startDateTime=<span class="token variable">$START_DATE</span>"</span>

<span class="token comment"># Nom du fichier avec date et heure</span>
FILENAME<span class="token operator">=</span><span class="token string">"events_data_<span class="token variable"><span class="token variable">$(</span><span class="token function">date</span> +%Y%m%d_%H%M%S<span class="token variable">)</span></span>.json"</span>

<span class="token comment"># R√©pertoire de stockage</span>
DIRECTORY<span class="token operator">=</span><span class="token string">"part_frequent_data"</span>

<span class="token comment"># Cr√©er le r√©pertoire s'il n'existe pas</span>
<span class="token function">mkdir</span> -p <span class="token string">"<span class="token variable">$DIRECTORY</span>"</span>

<span class="token comment"># Effectuer la requ√™te et sauvegarder les donn√©es</span>
curl -G <span class="token string">"<span class="token variable">$BASE_URL</span>"</span> \
  --data-urlencode <span class="token string">"apikey=<span class="token variable">$API_KEY</span>"</span> \
  --data-urlencode <span class="token string">"sort=date,desc"</span> \
  --data-urlencode <span class="token string">"startDateTime=<span class="token variable">$START_DATE</span>"</span> \
  -o <span class="token string">"<span class="token variable">$DIRECTORY</span>/<span class="token variable">$FILENAME</span>"</span>

<span class="token comment"># Confirmation de l'ex√©cution</span>
<span class="token keyword">echo</span> <span class="token string">"Donn√©es des √©v√©nements r√©cup√©r√©es et sauvegard√©es dans <span class="token variable">$DIRECTORY</span>/<span class="token variable">$FILENAME</span>"</span> 
</code></pre>
<h3 id="code-de-transformation">Code de Transformation</h3>
<pre class=" language-python"><code class="prism  language-python"><span class="token keyword">import</span> os
<span class="token keyword">import</span> json
<span class="token keyword">from</span> pymongo <span class="token keyword">import</span> MongoClient

<span class="token comment"># Connexion √† MongoDB</span>
client <span class="token operator">=</span> MongoClient<span class="token punctuation">(</span><span class="token string">'mongodb+srv://hamadygackou777:root@cluster0.1lwk5.mongodb.net/'</span><span class="token punctuation">)</span>
db <span class="token operator">=</span> client<span class="token punctuation">[</span><span class="token string">'Dashboard_Data_Science'</span><span class="token punctuation">]</span>
collection <span class="token operator">=</span> db<span class="token punctuation">[</span><span class="token string">'event'</span><span class="token punctuation">]</span>

<span class="token comment"># R√©pertoire contenant les fichiers JSON</span>
directory <span class="token operator">=</span> <span class="token string">'part_frequent_data'</span>

<span class="token comment"># Fonction pour extraire tous les attributs possibles</span>
<span class="token keyword">def</span> <span class="token function">extract_attributes</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">:</span>
    attributes <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token keyword">for</span> key<span class="token punctuation">,</span> value <span class="token keyword">in</span> data<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> <span class="token builtin">isinstance</span><span class="token punctuation">(</span>value<span class="token punctuation">,</span> <span class="token builtin">dict</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            nested_attributes <span class="token operator">=</span> extract_attributes<span class="token punctuation">(</span>value<span class="token punctuation">)</span>
            attributes<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> nested_attributes
        <span class="token keyword">elif</span> <span class="token builtin">isinstance</span><span class="token punctuation">(</span>value<span class="token punctuation">,</span> <span class="token builtin">list</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">if</span> value <span class="token operator">and</span> <span class="token builtin">isinstance</span><span class="token punctuation">(</span>value<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token builtin">dict</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                nested_list <span class="token operator">=</span> <span class="token punctuation">[</span>extract_attributes<span class="token punctuation">(</span>item<span class="token punctuation">)</span> <span class="token keyword">for</span> item <span class="token keyword">in</span> value<span class="token punctuation">]</span>
                attributes<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> nested_list
            <span class="token keyword">else</span><span class="token punctuation">:</span>
                attributes<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> value
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            <span class="token keyword">if</span> value <span class="token operator">not</span> <span class="token keyword">in</span> <span class="token punctuation">[</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token string">'NA'</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
                attributes<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> value
    <span class="token keyword">return</span> attributes

<span class="token comment"># Fonction pour r√©sumer les donn√©es</span>
<span class="token keyword">def</span> <span class="token function">summarize_data</span><span class="token punctuation">(</span>file_path<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>file_path<span class="token punctuation">,</span> <span class="token string">'r'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token builtin">file</span><span class="token punctuation">:</span>
        data <span class="token operator">=</span> json<span class="token punctuation">.</span>load<span class="token punctuation">(</span><span class="token builtin">file</span><span class="token punctuation">)</span>
        
        summary <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
        <span class="token keyword">for</span> event <span class="token keyword">in</span> data<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'_embedded'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'events'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            event_attributes <span class="token operator">=</span> extract_attributes<span class="token punctuation">(</span>event<span class="token punctuation">)</span>
            relevant_attributes <span class="token operator">=</span> <span class="token punctuation">{</span>
                <span class="token string">'name'</span><span class="token punctuation">:</span> event_attributes<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'name'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                <span class="token string">'type'</span><span class="token punctuation">:</span> event_attributes<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'type'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                <span class="token string">'dates'</span><span class="token punctuation">:</span> event_attributes<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'dates'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'start'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'localDate'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                <span class="token string">'venue'</span><span class="token punctuation">:</span> event_attributes<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'_embedded'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'venues'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'name'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                <span class="token string">'city'</span><span class="token punctuation">:</span> event_attributes<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'_embedded'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'venues'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'city'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'name'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                <span class="token string">'country'</span><span class="token punctuation">:</span> event_attributes<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'_embedded'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'venues'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'country'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'name'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                <span class="token string">'priceRanges'</span><span class="token punctuation">:</span> event_attributes<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'priceRanges'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token keyword">if</span> event_attributes<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'priceRanges'</span><span class="token punctuation">)</span> <span class="token keyword">else</span> <span class="token boolean">None</span><span class="token punctuation">,</span>
                <span class="token string">'sales'</span><span class="token punctuation">:</span> event_attributes<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'sales'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'public'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'startDateTime'</span><span class="token punctuation">)</span>
            <span class="token punctuation">}</span>
            
            relevant_attributes <span class="token operator">=</span> <span class="token punctuation">{</span>k<span class="token punctuation">:</span> v <span class="token keyword">for</span> k<span class="token punctuation">,</span> v <span class="token keyword">in</span> relevant_attributes<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">if</span> v <span class="token keyword">is</span> <span class="token operator">not</span> <span class="token boolean">None</span><span class="token punctuation">}</span>
            summary<span class="token punctuation">.</span>append<span class="token punctuation">(</span>relevant_attributes<span class="token punctuation">)</span>
        
        <span class="token keyword">return</span> summary

<span class="token comment"># Parcourir les fichiers dans le r√©pertoire</span>
<span class="token keyword">for</span> filename <span class="token keyword">in</span> os<span class="token punctuation">.</span>listdir<span class="token punctuation">(</span>directory<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span> filename<span class="token punctuation">.</span>endswith<span class="token punctuation">(</span><span class="token string">'.json'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        file_path <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>directory<span class="token punctuation">,</span> filename<span class="token punctuation">)</span>
        
        summary <span class="token operator">=</span> summarize_data<span class="token punctuation">(</span>file_path<span class="token punctuation">)</span>
        
        <span class="token keyword">for</span> event <span class="token keyword">in</span> summary<span class="token punctuation">:</span>
            query <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">'name'</span><span class="token punctuation">:</span> event<span class="token punctuation">[</span><span class="token string">'name'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">'dates'</span><span class="token punctuation">:</span> event<span class="token punctuation">[</span><span class="token string">'dates'</span><span class="token punctuation">]</span><span class="token punctuation">}</span>
            update <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">'$set'</span><span class="token punctuation">:</span> event<span class="token punctuation">}</span>
            collection<span class="token punctuation">.</span>update_one<span class="token punctuation">(</span>query<span class="token punctuation">,</span> update<span class="token punctuation">,</span> upsert<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
        
        os<span class="token punctuation">.</span>remove<span class="token punctuation">(</span>file_path<span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Donn√©es r√©sum√©es et stock√©es dans MongoDB avec succ√®s."</span><span class="token punctuation">)</span>

</code></pre>
<h3 id="api-football">2. API Football</h3>
<h3 id="code-dimportation-1">Code d‚Äôimportation</h3>
<pre class=" language-bash"><code class="prism  language-bash"><span class="token shebang important">#!/bin/bash</span>

<span class="token comment"># Cl√© API de l'API-Football</span>
<span class="token function">export</span> <span class="token punctuation">$(</span>grep -v <span class="token string">'^#'</span> <span class="token punctuation">..</span>/.env <span class="token operator">|</span> xargs<span class="token punctuation">)</span>

API_KEY<span class="token operator">=</span><span class="token string">"<span class="token variable">$API_KEY_foot</span>"</span>

<span class="token comment"># URL de base de l'API-Football</span>
BASE_URL<span class="token operator">=</span><span class="token string">"https://api.football-data.org/v4/competitions"</span>

<span class="token comment"># Param√®tres de la requ√™te</span>
LEAGUE_ID<span class="token operator">=</span>2021
START_DATE<span class="token operator">=</span><span class="token punctuation">$(</span>date -u -d <span class="token string">'30 days ago'</span> +%Y-%m-%d<span class="token punctuation">)</span>
END_DATE<span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">date</span> -u +%Y-%m-%d<span class="token variable">)</span></span>

<span class="token comment"># Nom du fichier avec date et heure</span>
FILENAME<span class="token operator">=</span><span class="token string">"football_past_performance_<span class="token variable"><span class="token variable">$(</span><span class="token function">date</span> +%Y%m%d_%H%M%S<span class="token variable">)</span></span>.json"</span>

<span class="token comment"># R√©pertoire de stockage</span>
DIRECTORY<span class="token operator">=</span><span class="token string">"football_data"</span>

<span class="token comment"># Cr√©er le r√©pertoire s'il n'existe pas</span>
<span class="token function">mkdir</span> -p <span class="token string">"<span class="token variable">$DIRECTORY</span>"</span>

<span class="token comment"># Effectuer la requ√™te et sauvegarder les donn√©es</span>
curl -G <span class="token string">"<span class="token variable">$BASE_URL</span>/<span class="token variable">$LEAGUE_ID</span>/matches"</span> \
  --header <span class="token string">"X-Auth-Token: <span class="token variable">$API_KEY</span>"</span> \
  --data-urlencode <span class="token string">"dateFrom=<span class="token variable">$START_DATE</span>"</span> \
  --data-urlencode <span class="token string">"dateTo=<span class="token variable">$END_DATE</span>"</span> \
  -o <span class="token string">"<span class="token variable">$DIRECTORY</span>/<span class="token variable">$FILENAME</span>"</span>

<span class="token comment"># Confirmation de l'ex√©cution</span>
<span class="token keyword">echo</span> <span class="token string">"Donn√©es des performances sportives pass√©es r√©cup√©r√©es et sauvegard√©es dans <span class="token variable">$DIRECTORY</span>/<span class="token variable">$FILENAME</span>"</span>

</code></pre>
<h3 id="code-de-transformation-1">Code de Transformation</h3>
<pre class=" language-python"><code class="prism  language-python"><span class="token keyword">import</span> os
<span class="token keyword">import</span> json
<span class="token keyword">from</span> pymongo <span class="token keyword">import</span> MongoClient

<span class="token comment"># Connexion √† MongoDB</span>
client <span class="token operator">=</span> MongoClient<span class="token punctuation">(</span><span class="token string">'mongodb+srv://hamadygackou777:root@cluster0.1lwk5.mongodb.net/'</span><span class="token punctuation">)</span>
db <span class="token operator">=</span> client<span class="token punctuation">[</span><span class="token string">'Dashboard_Data_Science'</span><span class="token punctuation">]</span>
collection <span class="token operator">=</span> db<span class="token punctuation">[</span><span class="token string">'football_past_performance'</span><span class="token punctuation">]</span>

<span class="token comment"># R√©pertoire contenant les fichiers JSON</span>
directory <span class="token operator">=</span> <span class="token string">'football_data'</span>

<span class="token comment"># Fonction pour r√©sumer les donn√©es</span>
<span class="token keyword">def</span> <span class="token function">summarize_data</span><span class="token punctuation">(</span>file_path<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>file_path<span class="token punctuation">,</span> <span class="token string">'r'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token builtin">file</span><span class="token punctuation">:</span>
        data <span class="token operator">=</span> json<span class="token punctuation">.</span>load<span class="token punctuation">(</span><span class="token builtin">file</span><span class="token punctuation">)</span>
        
        summary <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
        <span class="token keyword">for</span> match <span class="token keyword">in</span> data<span class="token punctuation">[</span><span class="token string">'matches'</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
            home_team <span class="token operator">=</span> match<span class="token punctuation">[</span><span class="token string">'homeTeam'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'name'</span><span class="token punctuation">]</span>
            away_team <span class="token operator">=</span> match<span class="token punctuation">[</span><span class="token string">'awayTeam'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'name'</span><span class="token punctuation">]</span>
            winner <span class="token operator">=</span> match<span class="token punctuation">[</span><span class="token string">'score'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'winner'</span><span class="token punctuation">]</span>
            
            <span class="token keyword">if</span> winner <span class="token operator">==</span> <span class="token string">'HOME_TEAM'</span><span class="token punctuation">:</span>
                performance_home_team <span class="token operator">=</span> <span class="token string">'winner'</span>
                performance_away_team <span class="token operator">=</span> <span class="token string">'loser'</span>
            <span class="token keyword">elif</span> winner <span class="token operator">==</span> <span class="token string">'AWAY_TEAM'</span><span class="token punctuation">:</span>
                performance_home_team <span class="token operator">=</span> <span class="token string">'loser'</span>
                performance_away_team <span class="token operator">=</span> <span class="token string">'winner'</span>
            <span class="token keyword">else</span><span class="token punctuation">:</span>
                performance_home_team <span class="token operator">=</span> <span class="token string">'draw'</span>
                performance_away_team <span class="token operator">=</span> <span class="token string">'draw'</span>
            
            summary<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">{</span>
                <span class="token string">'home_team'</span><span class="token punctuation">:</span> home_team<span class="token punctuation">,</span>
                <span class="token string">'away_team'</span><span class="token punctuation">:</span> away_team<span class="token punctuation">,</span>
                <span class="token string">'date'</span><span class="token punctuation">:</span> match<span class="token punctuation">[</span><span class="token string">'utcDate'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                <span class="token string">'status'</span><span class="token punctuation">:</span> match<span class="token punctuation">[</span><span class="token string">'status'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                <span class="token string">'competition'</span><span class="token punctuation">:</span> match<span class="token punctuation">[</span><span class="token string">'competition'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'name'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                <span class="token string">'score_home_team'</span><span class="token punctuation">:</span> match<span class="token punctuation">[</span><span class="token string">'score'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'fullTime'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'home'</span><span class="token punctuation">,</span> <span class="token string">'NA'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                <span class="token string">'score_away_team'</span><span class="token punctuation">:</span> match<span class="token punctuation">[</span><span class="token string">'score'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'fullTime'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'away'</span><span class="token punctuation">,</span> <span class="token string">'NA'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                <span class="token string">'performance_home_team'</span><span class="token punctuation">:</span> performance_home_team<span class="token punctuation">,</span>
                <span class="token string">'performance_away_team'</span><span class="token punctuation">:</span> performance_away_team
            <span class="token punctuation">}</span><span class="token punctuation">)</span>
        
        <span class="token keyword">return</span> summary

<span class="token comment"># Parcourir les fichiers dans le r√©pertoire</span>
<span class="token keyword">for</span> filename <span class="token keyword">in</span> os<span class="token punctuation">.</span>listdir<span class="token punctuation">(</span>directory<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span> filename<span class="token punctuation">.</span>endswith<span class="token punctuation">(</span><span class="token string">'.json'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        file_path <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>directory<span class="token punctuation">,</span> filename<span class="token punctuation">)</span>
        
        summary <span class="token operator">=</span> summarize_data<span class="token punctuation">(</span>file_path<span class="token punctuation">)</span>
        
        <span class="token keyword">for</span> match <span class="token keyword">in</span> summary<span class="token punctuation">:</span>
            query <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">'home_team'</span><span class="token punctuation">:</span> match<span class="token punctuation">[</span><span class="token string">'home_team'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">'away_team'</span><span class="token punctuation">:</span> match<span class="token punctuation">[</span><span class="token string">'away_team'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">'date'</span><span class="token punctuation">:</span> match<span class="token punctuation">[</span><span class="token string">'date'</span><span class="token punctuation">]</span><span class="token punctuation">}</span>
            update <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">'$set'</span><span class="token punctuation">:</span> match<span class="token punctuation">}</span>
            collection<span class="token punctuation">.</span>update_one<span class="token punctuation">(</span>query<span class="token punctuation">,</span> update<span class="token punctuation">,</span> upsert<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
        
        os<span class="token punctuation">.</span>remove<span class="token punctuation">(</span>file_path<span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Donn√©es r√©sum√©es et stock√©es dans MongoDB avec succ√®s."</span><span class="token punctuation">)</span>

</code></pre>
<h3 id="api-world-bank">3. API World Bank</h3>
<h3 id="code-dimportation-2">Code d‚Äôimportation</h3>
<pre class=" language-bash"><code class="prism  language-bash"><span class="token shebang important">#!/bin/bash</span>

WORLD_BANK_URL<span class="token operator">=</span><span class="token string">"http://api.worldbank.org/v2/country/all/indicator/NY.GDP.MKTP.CD?date=2013:2022&amp;format=json&amp;per_page=10000"</span>

ECON_DIRECTORY<span class="token operator">=</span><span class="token string">"economic_data"</span>

<span class="token function">mkdir</span> -p <span class="token string">"<span class="token variable">$ECON_DIRECTORY</span>"</span>   

PAGE<span class="token operator">=</span>1
TOTAL_PAGES<span class="token operator">=</span>1
COUNT<span class="token operator">=</span>0

<span class="token keyword">while</span> <span class="token punctuation">[</span> <span class="token variable">$PAGE</span> -le <span class="token variable">$TOTAL_PAGES</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">do</span>
  RESPONSE<span class="token operator">=</span><span class="token punctuation">$(</span>curl -s <span class="token string">"<span class="token variable">$WORLD_BANK_URL</span>&amp;page=<span class="token variable">$PAGE</span>"</span><span class="token punctuation">)</span>
  TOTAL_PAGES<span class="token operator">=</span><span class="token punctuation">$(</span>echo <span class="token variable">$RESPONSE</span> <span class="token operator">|</span> jq <span class="token string">'.[0].totalPages // 1'</span><span class="token punctuation">)</span>
  DATA<span class="token operator">=</span><span class="token punctuation">$(</span>echo <span class="token variable">$RESPONSE</span> <span class="token operator">|</span> jq <span class="token string">'.[1]'</span><span class="token punctuation">)</span>
  
  <span class="token keyword">while</span> <span class="token punctuation">[</span> <span class="token punctuation">$(</span>echo <span class="token variable">$DATA</span> <span class="token operator">|</span> jq <span class="token string">'length'</span><span class="token punctuation">)</span> -gt 0 <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">do</span>
    PART<span class="token operator">=</span><span class="token punctuation">$(</span>echo <span class="token variable">$DATA</span> <span class="token operator">|</span> jq <span class="token string">'.[0:1000]'</span><span class="token punctuation">)</span>
    DATA<span class="token operator">=</span><span class="token punctuation">$(</span>echo <span class="token variable">$DATA</span> <span class="token operator">|</span> jq <span class="token string">'.[1000:]'</span><span class="token punctuation">)</span>
    COUNT<span class="token operator">=</span><span class="token variable"><span class="token variable">$((</span>COUNT <span class="token operator">+</span> <span class="token number">1</span><span class="token variable">))</span></span>
    FILENAME<span class="token operator">=</span><span class="token string">"world_bank_data_<span class="token variable"><span class="token variable">$(</span><span class="token function">date</span> +%Y%m%d_%H%M%S<span class="token variable">)</span></span>_part_<span class="token variable">$COUNT</span>.json"</span>
    <span class="token keyword">echo</span> <span class="token variable">$PART</span> <span class="token operator">&gt;</span> <span class="token string">"<span class="token variable">$ECON_DIRECTORY</span>/<span class="token variable">$FILENAME</span>"</span>
  <span class="token keyword">done</span>

  PAGE<span class="token operator">=</span><span class="token variable"><span class="token variable">$((</span>PAGE <span class="token operator">+</span> <span class="token number">1</span><span class="token variable">))</span></span>
<span class="token keyword">done</span>

</code></pre>
<h3 id="code-de-transformation-2">Code de Transformation</h3>
<pre class=" language-python"><code class="prism  language-python"><span class="token keyword">import</span> os
<span class="token keyword">import</span> json
<span class="token keyword">from</span> pymongo <span class="token keyword">import</span> MongoClient
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

<span class="token comment"># Connexion √† MongoDB</span>
client <span class="token operator">=</span> MongoClient<span class="token punctuation">(</span><span class="token string">'mongodb+srv://hamadygackou777:root@cluster0.1lwk5.mongodb.net/'</span><span class="token punctuation">)</span>
db <span class="token operator">=</span> client<span class="token punctuation">[</span><span class="token string">'Dashboard_Data_Science'</span><span class="token punctuation">]</span>
collection <span class="token operator">=</span> db<span class="token punctuation">[</span><span class="token string">'economic_data'</span><span class="token punctuation">]</span>

<span class="token comment"># R√©pertoire contenant les fichiers JSON</span>
directory <span class="token operator">=</span> <span class="token string">'economic_data'</span>

<span class="token comment"># Fonction pour transformer les donn√©es en DataFrame</span>
<span class="token keyword">def</span> <span class="token function">process_economic_data</span><span class="token punctuation">(</span>file_path<span class="token punctuation">)</span><span class="token punctuation">:</span>
   <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>file_path<span class="token punctuation">,</span> <span class="token string">'r'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token builtin">file</span><span class="token punctuation">:</span>
       data <span class="token operator">=</span> json<span class="token punctuation">.</span>load<span class="token punctuation">(</span><span class="token builtin">file</span><span class="token punctuation">)</span>
       
       records <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
       <span class="token keyword">for</span> record <span class="token keyword">in</span> data<span class="token punctuation">:</span>
           records<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">{</span>
               <span class="token string">'country'</span><span class="token punctuation">:</span> record<span class="token punctuation">[</span><span class="token string">'country'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'value'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
               <span class="token string">'indicator'</span><span class="token punctuation">:</span> record<span class="token punctuation">[</span><span class="token string">'indicator'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'value'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
               <span class="token string">'value'</span><span class="token punctuation">:</span> record<span class="token punctuation">[</span><span class="token string">'value'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
               <span class="token string">'date'</span><span class="token punctuation">:</span> record<span class="token punctuation">[</span><span class="token string">'date'</span><span class="token punctuation">]</span>
           <span class="token punctuation">}</span><span class="token punctuation">)</span>
       
       <span class="token keyword">return</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>records<span class="token punctuation">)</span>

<span class="token comment"># Fonction pour ins√©rer les donn√©es dans MongoDB</span>
<span class="token keyword">def</span> <span class="token function">insert_data_to_mongo</span><span class="token punctuation">(</span>dataframe<span class="token punctuation">)</span><span class="token punctuation">:</span>
   <span class="token keyword">for</span> _<span class="token punctuation">,</span> row <span class="token keyword">in</span> dataframe<span class="token punctuation">.</span>iterrows<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
       record <span class="token operator">=</span> row<span class="token punctuation">.</span>to_dict<span class="token punctuation">(</span><span class="token punctuation">)</span>
       collection<span class="token punctuation">.</span>update_one<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">'country'</span><span class="token punctuation">:</span> record<span class="token punctuation">[</span><span class="token string">'country'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">'indicator'</span><span class="token punctuation">:</span> record<span class="token punctuation">[</span><span class="token string">'indicator'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">'date'</span><span class="token punctuation">:</span> record<span class="token punctuation">[</span><span class="token string">'date'</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">,</span> 
                             <span class="token punctuation">{</span><span class="token string">'$set'</span><span class="token punctuation">:</span> record<span class="token punctuation">}</span><span class="token punctuation">,</span> upsert<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>

<span class="token comment"># Parcourir les fichiers dans le r√©pertoire</span>
<span class="token keyword">for</span> filename <span class="token keyword">in</span> os<span class="token punctuation">.</span>listdir<span class="token punctuation">(</span>directory<span class="token punctuation">)</span><span class="token punctuation">:</span>
   <span class="token keyword">if</span> filename<span class="token punctuation">.</span>endswith<span class="token punctuation">(</span><span class="token string">'.json'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
       file_path <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>directory<span class="token punctuation">,</span> filename<span class="token punctuation">)</span>
       
       df <span class="token operator">=</span> process_economic_data<span class="token punctuation">(</span>file_path<span class="token punctuation">)</span>
       insert_data_to_mongo<span class="token punctuation">(</span>df<span class="token punctuation">)</span>
       
       os<span class="token punctuation">.</span>remove<span class="token punctuation">(</span>file_path<span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Donn√©es √©conomiques trait√©es et stock√©es dans MongoDB avec succ√®s."</span><span class="token punctuation">)</span>

</code></pre>
<h2 id="fichier-chron-">Fichier Chron :</h2>
<pre class=" language-bash"><code class="prism  language-bash"><span class="token shebang important">#!/bin/bash</span>

<span class="token comment"># Arr√™te le script en cas d'erreur</span>
<span class="token keyword">set</span> -e
 
<span class="token comment"># Ex√©cution des scripts Bash</span>

<span class="token comment"># V√©rifie et ex√©cute le script event_bash.sh</span>
<span class="token keyword">if</span> <span class="token punctuation">[</span> -d <span class="token string">"event"</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
    <span class="token function">cd</span> event
    <span class="token keyword">if</span> <span class="token punctuation">[</span> -f <span class="token string">"event_bash.sh"</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
        <span class="token function">bash</span> event_bash.sh
    <span class="token keyword">else</span>
        <span class="token keyword">echo</span> <span class="token string">"Erreur : le script 'event_bash.sh' est introuvable dans le r√©pertoire 'event'."</span>
        <span class="token keyword">exit</span> 1
    <span class="token keyword">fi</span>
    <span class="token function">cd</span> <span class="token punctuation">..</span>
<span class="token keyword">else</span>
    <span class="token keyword">echo</span> <span class="token string">"Erreur : le r√©pertoire 'event' n'existe pas."</span>
    <span class="token keyword">exit</span> 1
<span class="token keyword">fi</span>

<span class="token comment"># V√©rifie et ex√©cute le script performance_sportive_bash.sh</span>
<span class="token keyword">if</span> <span class="token punctuation">[</span> -d <span class="token string">"football"</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
    <span class="token function">cd</span> football
    <span class="token keyword">if</span> <span class="token punctuation">[</span> -f <span class="token string">"performance_sportive_bash.sh"</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
        <span class="token function">bash</span> performance_sportive_bash.sh
    <span class="token keyword">else</span>
        <span class="token keyword">echo</span> <span class="token string">"Erreur : le script 'performance_sportive_bash.sh' est introuvable dans le r√©pertoire 'football'."</span>
        <span class="token keyword">exit</span> 1
    <span class="token keyword">fi</span>
    <span class="token function">cd</span> <span class="token punctuation">..</span>
<span class="token keyword">else</span>
    <span class="token keyword">echo</span> <span class="token string">"Erreur : le r√©pertoire 'football' n'existe pas."</span>
    <span class="token keyword">exit</span> 1
<span class="token keyword">fi</span>

<span class="token function">sleep</span> 10

<span class="token comment"># Ex√©cution des scripts Python</span>
<span class="token keyword">if</span> <span class="token punctuation">[</span> -d <span class="token string">"event"</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
    <span class="token function">cd</span> event
    <span class="token keyword">if</span> <span class="token punctuation">[</span> -f <span class="token string">"summarize_event.py"</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
        python summarize_event.py
    <span class="token keyword">else</span>
        <span class="token keyword">echo</span> <span class="token string">"Erreur : le script 'summarize_event.py' est introuvable dans le r√©pertoire 'event'."</span>
        <span class="token keyword">exit</span> 1
    <span class="token keyword">fi</span>
    <span class="token function">cd</span> <span class="token punctuation">..</span>
<span class="token keyword">else</span>
    <span class="token keyword">echo</span> <span class="token string">"Erreur : le r√©pertoire 'event' n'existe pas."</span>
    <span class="token keyword">exit</span> 1
<span class="token keyword">fi</span>

<span class="token keyword">if</span> <span class="token punctuation">[</span> -d <span class="token string">"football"</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
    <span class="token function">cd</span> football
    <span class="token keyword">if</span> <span class="token punctuation">[</span> -f <span class="token string">"summarize_performance_sportive.py"</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
        python summarize_performance_sportive.py
    <span class="token keyword">else</span>
        <span class="token keyword">echo</span> <span class="token string">"Erreur : le script 'summarize_performance_sportive.py' est introuvable dans le r√©pertoire 'football'."</span>
        <span class="token keyword">exit</span> 1
    <span class="token keyword">fi</span>
    <span class="token function">cd</span> <span class="token punctuation">..</span>
<span class="token keyword">else</span>
    <span class="token keyword">echo</span> <span class="token string">"Erreur : le r√©pertoire 'football' n'existe pas."</span>
    <span class="token keyword">exit</span> 1
<span class="token keyword">fi</span>

<span class="token comment"># Obtenir la date et l'heure actuelles</span>
now<span class="token operator">=</span><span class="token punctuation">$(</span>date +<span class="token string">"%Y-%m-%d %H:%M:%S"</span><span class="token punctuation">)</span>

<span class="token comment"># D√©finir l'objet de l'e-mail</span>
email_subject<span class="token operator">=</span><span class="token string">"Email du <span class="token variable">$now</span>"</span>

<span class="token comment"># D√©finir le corps de l'e-mail</span>
email_body<span class="token operator">=</span><span class="token string">"Salut,\n\nCeci est votre t√¢che planifi√©e qui fonctionne .\n\nCordialement."</span>

<span class="token comment"># M'envoyer un email √†  chaque execution de la tache cron </span>
<span class="token keyword">echo</span> -e <span class="token string">"Subject: <span class="token variable">$email_subject</span>\n\n<span class="token variable">$email_body</span>"</span> <span class="token operator">|</span> msmtp --from<span class="token operator">=</span><span class="token string">"Hamady GACKOU"</span> -a default hamadygackou777@gmail.com

</code></pre>
<h2 id="cron-job---automatisation-du--fichier-chron-ci-dessus">Cron Job :  Automatisation du  fichier chron ci dessus</h2>
<p>0 */3 * * *   <a href="http://crontab.sh">crontab.sh</a> &gt;&gt;  cron.log 2&gt;&amp;1</p>
<h2 id="exploration-de-la-base-de-donn√©es-mongodb">Exploration de la base de donn√©es MongoDB</h2>
<p>Pour explorer la base de donn√©es, il faut t√©l√©charger MongoDB Compass et se connecter √† la base avec ce lien :<br>
<code>mongodb+srv://&lt;db_username&gt;:&lt;db_password&gt;@cluster0.1lwk5.mongodb.net/</code></p>
<ul>
<li><strong>db_username</strong> : <code>user</code></li>
<li><strong>db_password</strong> : <code>user</code></li>
</ul>
<h2 id="cron-job">Cron Job</h2>
<ul>
<li>0 */3 * * * /path/vers/crontab.sh</li>
</ul>
<h2 id="conception-du-tableau--de-bord-">Conception du tableau  de bord :</h2>
<h3 id="outils-utilis√©s">Outils utilis√©s</h3>
<p>Pour ce projet, j‚Äôai utilis√© une combinaison d‚Äôoutils modernes afin de concevoir un tableau de bord interactif, performant et robuste  :</p>
<ul>
<li><strong>Streamlit</strong> : Framework principal pour cr√©er une interface utilisateur intuitive et interactive, adapt√©e √† l‚Äôanalyse de donn√©es multi-sources en temps r√©el.</li>
<li><strong>Pandas</strong> : Manipulation, nettoyage et transformation des donn√©es pour garantir leur qualit√© avant analyse.</li>
<li><strong>Plotly</strong> : G√©n√©ration de visualisations dynamiques et interactives, telles que des graphiques et des cartes g√©ographiques.</li>
<li><strong>Pymongo</strong> : Connexion et extraction des donn√©es depuis MongoDB pour int√©grer des informations actualis√©es dans le tableau de bord.</li>
<li><strong>Sklearn</strong> : Impl√©mentation de mod√®les de machine learning pour la d√©tection d‚Äôanomalies et la pr√©diction des tendances.</li>
</ul>
<p>Ces outils m‚Äôont permis de combiner analyse, visualisation et interactivit√©, r√©pondant ainsi aux objectifs de ce projet ambitieux.</p>
<h2 id="difficult√©s-de-d√©ploiement-des-t√¢ches-planifi√©es-sur-les-plateformes-de-d√©ploiement-">Difficult√©s de D√©ploiement des T√¢ches Planifi√©es sur les Plateformes de D√©ploiement :</h2>
<p>J‚Äôattire l‚Äôattention sur le fait que l‚Äôex√©cution de t√¢ches planifi√©es via des scripts bash a √©t√© compromise par les limitations de Streamlit Cloud, qui ne prend pas en charge les t√¢ches cron. Je souligne √©galement que, bien que Heroku ait √©t√© envisag√© comme solution, son recours √† des dynos payants d√©passait les contraintes de mon budget. Les t√¢ches cron ne sont donc pas fonctionnelles sur le serveur utilis√© pour mon d√©ploiement, Streamlit Cloud.</p>
<h2 id="lien-du--repo-github--">Lien du  repo Github  :</h2>
<p><a href="https://github.com/gackouhamady/Culture_Analysis">https://github.com/gackouhamady/Culture_Analysis</a></p>
<ul>
<li>NB : Pour un test en local, pour tout probl√®me li√© aux biblioth√®ques, vous pouvez installer un environnement virtuel Python et faire fonctionner les scripts  .</li>
</ul>
<h2 id="conclusion-">Conclusion :</h2>
<p>Ce projet de tableau de bord en temps r√©el a permis d‚Äôint√©grer et d‚Äôanalyser des donn√©es provenant de diverses sources, telles que les √©v√©nements culturels, les performances sportives et les indicateurs √©conomiques. Gr√¢ce √† des outils comme Streamlit, Pandas, Plotly, Pymongo et Sklearn, nous avons pu cr√©er une interface interactive et intuitive, offrant des insights pr√©cieux sur l‚Äôimpact des √©v√©nements sur l‚Äô√©conomie locale.</p>
<h2 id="perspectives-">Perspectives :</h2>
<p>Pour l‚Äôavenir, nous pourrions √©largir les sources de donn√©es, am√©liorer les mod√®les pr√©dictifs, personnaliser davantage l‚Äôinterface utilisateur, int√©grer des analyses g√©ospatiales avanc√©es, ajouter des fonctionnalit√©s de collaboration et connecter le tableau de bord √† d‚Äôautres syst√®mes d‚Äôinformation pour automatiser les flux de travail. Ces am√©liorations rendront l‚Äôoutil encore plus utile pour les gestionnaires d‚Äô√©v√©nements, les √©conomistes et les autorit√©s locales.</p>
</div>
</body>

</html>
